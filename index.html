<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üßÄ SOysdomofon - –°–∏–º—É–ª—è—Ç–æ—Ä –û–±–º–∞–∑—ã–≤–∞–Ω–∏—è –î–æ–º–æ—Ñ–æ–Ω–∞ üö™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes cheeseFloat {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-200px) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes orbit {
            from { transform: rotate(0deg) translateX(150px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(150px) rotate(-360deg); }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        /* === –≠–ö–†–ê–ù –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò === */
        .auth-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .auth-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.5);
            padding: 50px 40px;
            max-width: 450px;
            width: 100%;
            animation: slideIn 0.6s ease;
        }

        .auth-logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-logo h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .auth-logo p {
            color: #7f8c8d;
            font-size: 0.95em;
        }

        .auth-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            border: none;
            background: #ecf0f1;
            color: #7f8c8d;
            border-radius: 15px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .auth-tab.active {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ecf0f1;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .form-group input:focus {
            outline: none;
            border-color: #f39c12;
            background: white;
        }

        .auth-button {
            width: 100%;
            padding: 18px;
            border: none;
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .auth-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(243, 156, 18, 0.4);
        }

        .error-message, .success-message {
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 14px;
            animation: slideIn 0.3s ease;
        }

        .error-message {
            background: #e74c3c;
            color: white;
        }

        .success-message {
            background: #27ae60;
            color: white;
        }

        /* === –ò–ì–†–û–í–û–ô –≠–ö–†–ê–ù === */
        .game-screen {
            display: none;
            padding: 20px;
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px 30px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .header-left h1 {
            font-size: 2em;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header-left p {
            color: #ecf0f1;
            font-size: 0.9em;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
        }

        .logout-btn, .admin-btn, .transfer-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn {
            background: #e74c3c;
        }

        .logout-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .admin-btn {
            background: #9b59b6;
        }

        .admin-btn:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        .transfer-btn {
            background: #3498db;
        }

        .transfer-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        /* === –ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–û–ë–©–ï–ù–ò–ï === */
        .global-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            color: #f39c12;
            padding: 40px 60px;
            border-radius: 20px;
            font-size: 2em;
            font-weight: 700;
            text-align: center;
            z-index: 10001;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
            animation: slideIn 0.5s ease;
            max-width: 80%;
            border: 3px solid #f39c12;
        }

        .global-message .author {
            color: #e67e22;
            font-size: 0.6em;
            margin-bottom: 10px;
        }

        /* === –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø === */
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: rgba(52, 152, 219, 0.95);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 10000;
            animation: slideIn 0.5s ease;
            max-width: 400px;
        }

        .notification.success {
            background: rgba(39, 174, 96, 0.95);
        }

        .notification.error {
            background: rgba(231, 76, 60, 0.95);
        }

        /* === –ï–í–ï–ù–¢–´ === */
        .event-banner {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 50px;
            border-radius: 30px;
            z-index: 9999;
            text-align: center;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.8);
            animation: slideIn 0.7s ease;
            border: 4px solid;
        }

        .event-icon {
            font-size: 5em;
            margin-bottom: 20px;
        }

        .event-title {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .event-starter {
            font-size: 1.2em;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .event-multiplier {
            font-size: 3em;
            font-weight: 700;
            color: #f39c12;
            margin: 20px 0;
        }

        .event-timer {
            font-size: 1.5em;
            color: #ecf0f1;
        }

        .event-indicator {
            position: fixed;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 30px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 9998;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: pulse 2s infinite;
        }

        .event-indicator .icon {
            font-size: 2em;
        }

        .event-indicator .info {
            text-align: left;
        }

        .event-indicator .name {
            font-weight: 700;
            font-size: 1.1em;
        }

        .event-indicator .time {
            color: #bdc3c7;
            font-size: 0.9em;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç—ã –µ–≤–µ–Ω—Ç–æ–≤ */
        .event-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9997;
        }

        .star {
            position: absolute;
            width: 3px;
            height: 3px;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite;
        }

        .orbit-particle {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            animation: orbit 10s linear infinite;
        }

        .rainbow-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(255,0,0,0.1), 
                rgba(255,154,0,0.1), 
                rgba(208,222,33,0.1), 
                rgba(79,220,74,0.1), 
                rgba(63,218,216,0.1), 
                rgba(47,201,226,0.1), 
                rgba(28,127,238,0.1), 
                rgba(95,21,242,0.1), 
                rgba(186,12,248,0.1));
            animation: rainbow 5s linear infinite;
            pointer-events: none;
            z-index: 9997;
        }

        /* === –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê === */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #2c3e50;
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.8);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-size: 2em;
            color: #f39c12;
        }

        .close-modal {
            background: #e74c3c;
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .close-modal:hover {
            background: #c0392b;
            transform: rotate(90deg);
        }

        .modal-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .modal-tab {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .modal-tab.active {
            background: #f39c12;
        }

        .admin-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .admin-section h3 {
            color: #f39c12;
            margin-bottom: 15px;
        }

        .admin-input {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
        }

        .admin-input:focus {
            outline: none;
            border-color: #f39c12;
        }

        .admin-button {
            padding: 12px 25px;
            background: #27ae60;
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .admin-button:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .admin-button.danger {
            background: #e74c3c;
        }

        .admin-button.danger:hover {
            background: #c0392b;
        }

        .user-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-item.banned {
            opacity: 0.5;
            border: 2px solid #e74c3c;
        }

        .event-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .event-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .event-card:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #f39c12;
            transform: translateY(-5px);
        }

        .event-card .icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .event-card .name {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .event-card .mult {
            color: #f39c12;
            font-size: 1.2em;
        }

        .main-content {
            display: grid;
            grid-template-columns: 320px 1fr 340px;
            gap: 20px;
        }

        @media (max-width: 1400px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* === –°–¢–ê–¢–ò–°–¢–ò–ö–ê === */
        .stats-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .stats-panel h2 {
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #f39c12;
        }

        .stat-label {
            color: #bdc3c7;
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: 700;
            color: #f39c12;
        }

        .rebirth-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.1);
        }

        .rebirth-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            border: none;
            border-radius: 15px;
            color: white;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .rebirth-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(155, 89, 182, 0.4);
        }

        .rebirth-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* === –ò–ì–†–û–í–ê–Ø –ó–û–ù–ê === */
        .game-area {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .cheese-counter {
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            animation: pulse 2s infinite;
        }

        .intercom-container {
            position: relative;
            display: inline-block;
            margin: 30px 0;
        }

        .intercom {
            width: 300px;
            height: 400px;
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .intercom:hover {
            transform: scale(1.05);
        }

        .intercom:active {
            transform: scale(0.98);
        }

        .intercom-screen {
            width: 80%;
            height: 30%;
            background: #1abc9c;
            margin: 20px auto;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: 700;
            color: #2c3e50;
        }

        .intercom-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 20px;
        }

        .intercom-btn {
            width: 100%;
            aspect-ratio: 1;
            background: #7f8c8d;
            border-radius: 50%;
            border: 3px solid #95a5a6;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cheese-splash {
            position: fixed;
            pointer-events: none;
            font-size: 2em;
            animation: cheeseFloat 1.5s ease-out forwards;
            z-index: 9999;
            font-weight: bold;
        }

        .click-power {
            color: #f39c12;
            font-size: 1.1em;
            margin-top: 10px;
        }

        /* === –ú–ê–ì–ê–ó–ò–ù === */
        .shop-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            max-height: 80vh;
            overflow-y: auto;
        }

        .shop-panel h2 {
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.8em;
        }

        .shop-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .shop-tab {
            flex: 1;
            min-width: 80px;
            padding: 10px 5px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .shop-tab.active {
            background: #f39c12;
        }

        .shop-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }

        .shop-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: #f39c12;
            transform: translateX(5px);
        }

        .shop-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .shop-item-name {
            font-weight: 700;
            font-size: 0.95em;
        }

        .shop-item-level {
            background: #f39c12;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .shop-item-desc {
            color: #bdc3c7;
            font-size: 0.85em;
            margin-bottom: 10px;
        }

        .shop-item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .shop-item-cost {
            font-size: 1.05em;
            font-weight: 700;
            color: #f39c12;
        }

        .buy-btn, .select-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .buy-btn {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .buy-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }

        .buy-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .select-btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .select-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .select-btn.active {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        /* === –õ–ò–î–ï–†–ë–û–†–î === */
        .leaderboard {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .leaderboard h2 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .leaderboard-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
        }

        .leaderboard-tab {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .leaderboard-tab.active {
            background: #f39c12;
        }

        .leaderboard-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .leaderboard-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .leaderboard-rank {
            width: 40px;
            height: 40px;
            background: #f39c12;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2em;
        }

        .leaderboard-rank.gold {
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
        }

        .leaderboard-rank.silver {
            background: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%);
        }

        .leaderboard-rank.bronze {
            background: linear-gradient(135deg, #d35400 0%, #e67e22 100%);
        }

        .leaderboard-player {
            flex: 1;
            margin-left: 15px;
            font-weight: 600;
        }

        .leaderboard-score {
            font-weight: 700;
            color: #f39c12;
            font-size: 1.2em;
        }

        /* === –°–ö–†–û–õ–õ–ë–ê–† === */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #f39c12;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #e67e22;
        }

        .hidden {
            display: none !important;
        }

        textarea {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            min-height: 100px;
        }

        textarea:focus {
            outline: none;
            border-color: #f39c12;
        }

        select {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            cursor: pointer;
        }

        select:focus {
            outline: none;
            border-color: #f39c12;
        }

        select option {
            background: #2c3e50;
            color: white;
        }
    </style>
</head>
<body>

    <!-- –≠–ö–†–ê–ù –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-logo">
                <h1>üßÄ SOysdomofon</h1>
                <p>–°–∏–º—É–ª—è—Ç–æ—Ä –û–±–º–∞–∑—ã–≤–∞–Ω–∏—è –î–æ–º–æ—Ñ–æ–Ω–∞</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab">–í—Ö–æ–¥</button>
                <button class="auth-tab" id="registerTab">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>

            <div id="errorMessage" class="error-message hidden"></div>
            <div id="successMessage" class="success-message hidden"></div>

            <form id="authForm">
                <div class="form-group">
                    <label>–õ–æ–≥–∏–Ω</label>
                    <input type="text" id="loginInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω" required>
                </div>

                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="passwordInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>

                <button type="submit" class="auth-button" id="authButton">–í–û–ô–¢–ò</button>
            </form>
        </div>
    </div>

    <!-- –ò–ì–†–û–í–û–ô –≠–ö–†–ê–ù -->
    <div id="gameScreen" class="game-screen">
        <div class="header">
            <div class="header-left">
                <h1>üßÄ SOysdomofon</h1>
                <p>–ò–≥—Ä–æ–∫: <span id="playerName"></span></p>
            </div>
            <div class="header-buttons">
                <button class="transfer-btn" id="transferBtn">üí∏ –ü–µ—Ä–µ–≤–æ–¥</button>
                <button class="admin-btn hidden" id="adminBtn">‚öôÔ∏è –ê–¥–º–∏–Ω</button>
                <button class="logout-btn" id="logoutBtn">–í—ã—Ö–æ–¥</button>
            </div>
        </div>

        <div class="main-content">
            <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
            <div class="stats-panel">
                <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                
                <div class="stat-item">
                    <div class="stat-label">–°—ã—Ä–∞ –≤ —Å–µ–∫—É–Ω–¥—É</div>
                    <div class="stat-value" id="cheesePerSec">0</div>
                </div>

                <div class="stat-item">
                    <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
                    <div class="stat-value" id="levelDisplay">1</div>
                </div>

                <div class="stat-item">
                    <div class="stat-label">–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                    <div class="stat-value" id="totalCheese">0</div>
                </div>

                <div class="stat-item">
                    <div class="stat-label">–û–±–º–∞–∑–∞–Ω–æ –¥–æ–º–æ—Ñ–æ–Ω–æ–≤</div>
                    <div class="stat-value" id="intercomsSmeared">0</div>
                </div>

                <div class="rebirth-section">
                    <div class="stat-item">
                        <div class="stat-label">‚≠ê –ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è</div>
                        <div class="stat-value" id="rebirthCount">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                        <div class="stat-value">x<span id="rebirthBonus">1</span></div>
                    </div>
                    <button class="rebirth-btn" id="rebirthBtn">
                        ‚≠ê –ü–ï–†–ï–†–û–î–ò–¢–¨–°–Ø (<span id="rebirthCost">1,000,000</span> üßÄ)
                    </button>
                </div>
            </div>

            <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ü–ê–ù–ï–õ–¨ - –ò–ì–†–û–í–ê–Ø –ó–û–ù–ê -->
            <div>
                <div class="game-area">
                    <div class="cheese-counter">
                        üßÄ <span id="cheeseCount">0</span>
                    </div>

                    <div class="intercom-container">
                        <div class="intercom" id="intercom">
                            <div class="intercom-screen">
                                <span id="intercomName">CYFRAL</span>
                            </div>
                            <div class="intercom-buttons">
                                <div class="intercom-btn">1</div>
                                <div class="intercom-btn">2</div>
                                <div class="intercom-btn">3</div>
                                <div class="intercom-btn">4</div>
                                <div class="intercom-btn">5</div>
                                <div class="intercom-btn">6</div>
                                <div class="intercom-btn">7</div>
                                <div class="intercom-btn">8</div>
                                <div class="intercom-btn">9</div>
                                <div class="intercom-btn">*</div>
                                <div class="intercom-btn">0</div>
                                <div class="intercom-btn">#</div>
                            </div>
                        </div>
                    </div>

                    <div class="click-power">
                        ‚ö° +<span id="clickPower">1</span> —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫
                    </div>
                </div>

                <div class="leaderboard">
                    <h2>üèÜ –¢–æ–ø –ò–≥—Ä–æ–∫–æ–≤</h2>
                    
                    <div class="leaderboard-tabs">
                        <button class="leaderboard-tab active" data-lb-tab="balance">–ü–æ –±–∞–ª–∞–Ω—Å—É</button>
                        <button class="leaderboard-tab" data-lb-tab="rebirths">–ü–æ –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è–º</button>
                        <button class="leaderboard-tab" data-lb-tab="all">–û–±—â–∏–π —Ç–æ–ø</button>
                    </div>

                    <div id="leaderboardList">
                        <div style="text-align: center; color: #bdc3c7; padding: 20px;">
                            –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏–¥–µ—Ä–æ–≤...
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –ú–ê–ì–ê–ó–ò–ù -->
            <div class="shop-panel">
                <h2>üõí –ú–∞–≥–∞–∑–∏–Ω</h2>

                <div class="shop-tabs">
                    <button class="shop-tab active" data-tab="upgrades">–£–ª—É—á—à–µ–Ω–∏—è</button>
                    <button class="shop-tab" data-tab="intercoms">–î–æ–º–æ—Ñ–æ–Ω—ã</button>
                    <button class="shop-tab" data-tab="sauce">–°–æ—É—Å—ã</button>
                </div>

                <div id="upgradesTab" class="shop-content"></div>
                <div id="intercomsTab" class="shop-content hidden"></div>
                <div id="sauceTab" class="shop-content hidden"></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –ü–ï–†–ï–í–û–î–ê -->
    <div id="transferModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üí∏ –ü–µ—Ä–µ–≤–æ–¥ —Å—ã—Ä–∞</h2>
                <button class="close-modal" onclick="closeTransferModal()">√ó</button>
            </div>

            <div class="admin-section">
                <input type="text" class="admin-input" id="transferRecipient" placeholder="–õ–æ–≥–∏–Ω –ø–æ–ª—É—á–∞—Ç–µ–ª—è">
                <input type="number" class="admin-input" id="transferAmount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—ã—Ä–∞">
                <button class="admin-button" onclick="sendTransfer()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>
            </div>
        </div>
    </div>

    <!-- –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</h2>
                <button class="close-modal" onclick="closeAdminModal()">√ó</button>
            </div>

            <div class="modal-tabs">
                <button class="modal-tab active" data-admin-tab="users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                <button class="modal-tab" data-admin-tab="broadcast">–û–±—ä—è–≤–ª–µ–Ω–∏–µ</button>
                <button class="modal-tab" data-admin-tab="events">–ï–≤–µ–Ω—Ç—ã</button>
            </div>

            <div id="usersAdminTab" class="admin-tab-content"></div>
            <div id="broadcastAdminTab" class="admin-tab-content hidden"></div>
            <div id="eventsAdminTab" class="admin-tab-content hidden"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, get, onValue, update, remove } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            databaseURL: "https://sirnik-3356a-default-rtdb.firebaseio.com/"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        let currentUser = null;
        let isAuthMode = true;
        let currentEventMultiplier = 1;
        let currentEventData = null;
        let gameData = {
            cheese: 0,
            totalCheese: 0,
            allTimeCheese: 0,
            level: 1,
            rebirths: 0,
            clickPower: 1,
            cheesePerSecond: 0,
            upgrades: {},
            intercoms: ['cyfral'],
            currentIntercom: 'cyfral',
            sauces: ['basic'],
            currentSauce: 'basic',
            intercomBonus: 1,
            sauceBonus: 0,
            isAdmin: false,
            isBanned: false
        };

        // –û–≥—Ä–æ–º–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–ª—É—á—à–µ–Ω–∏–π (40+ —à—Ç—É–∫)
        const upgradesList = [
            // –£–ª—É—á—à–µ–Ω–∏—è –∫–ª–∏–∫–æ–≤
            { id: 'finger', name: 'üëÜ –°–∏–ª—å–Ω—ã–π –ø–∞–ª–µ—Ü', desc: '+1 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 50, type: 'click', power: 1, scale: 1.5 },
            { id: 'glove', name: 'üß§ –†–µ–∑–∏–Ω–æ–≤–∞—è –ø–µ—Ä—á–∞—Ç–∫–∞', desc: '+3 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 250, type: 'click', power: 3, scale: 1.5 },
            { id: 'brush2', name: 'üñåÔ∏è –ö–∏—Å—Ç–æ—á–∫–∞', desc: '+8 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 1000, type: 'click', power: 8, scale: 1.6 },
            { id: 'roller', name: 'üñåÔ∏è –í–∞–ª–∏–∫', desc: '+20 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 5000, type: 'click', power: 20, scale: 1.6 },
            { id: 'sprayer', name: 'üíß –ü—É–ª—å–≤–µ—Ä–∏–∑–∞—Ç–æ—Ä', desc: '+50 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 25000, type: 'click', power: 50, scale: 1.7 },
            { id: 'bucket', name: 'ü™£ –í–µ–¥—Ä–æ —Å —Å—ã—Ä–æ–º', desc: '+150 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 100000, type: 'click', power: 150, scale: 1.7 },
            { id: 'hose', name: 'üöø –®–ª–∞–Ω–≥', desc: '+400 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 500000, type: 'click', power: 400, scale: 1.8 },
            { id: 'cannon', name: 'üí£ –°—ã—Ä–Ω–∞—è –ø—É—à–∫–∞', desc: '+1000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 2500000, type: 'click', power: 1000, scale: 1.8 },
            { id: 'catapult', name: 'üèπ –ö–∞—Ç–∞–ø—É–ª—å—Ç–∞', desc: '+2500 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 10000000, type: 'click', power: 2500, scale: 1.9 },
            { id: 'trebuchet', name: '‚öîÔ∏è –¢—Ä–µ–±—É—à–µ—Ç', desc: '+7000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 50000000, type: 'click', power: 7000, scale: 1.9 },
            { id: 'ballista', name: 'üèπ –ë–∞–ª–ª–∏—Å—Ç–∞', desc: '+20000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 250000000, type: 'click', power: 20000, scale: 2.0 },
            { id: 'nuke', name: '‚ò¢Ô∏è –Ø–¥–µ—Ä–Ω–∞—è –±–æ–º–±–∞', desc: '+60000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫', baseCost: 1000000000, type: 'click', power: 60000, scale: 2.0 },
            
            // –ê–≤—Ç–æ-–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
            { id: 'auto', name: 'ü§ñ –†–æ–±–æ—Ç-–≥—É–±–∫–∞', desc: '+1 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 100, type: 'auto', power: 1, scale: 1.7 },
            { id: 'sponge', name: 'üßΩ –£–º–Ω–∞—è –≥—É–±–∫–∞', desc: '+5 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 500, type: 'auto', power: 5, scale: 1.7 },
            { id: 'drone', name: 'üöÅ –î—Ä–æ–Ω-–æ–±–º–∞–∑—ã–≤–∞—Ç–µ–ª—å', desc: '+15 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 2500, type: 'auto', power: 15, scale: 1.8 },
            { id: 'brush', name: 'üñåÔ∏è –ê–≤—Ç–æ-–∫–∏—Å—Ç—å', desc: '+50 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 10000, type: 'auto', power: 50, scale: 1.8 },
            { id: 'spray', name: 'üí¶ –ê–≤—Ç–æ-—Ä–∞—Å–ø—ã–ª–∏—Ç–µ–ª—å', desc: '+150 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 50000, type: 'auto', power: 150, scale: 1.9 },
            { id: 'machine', name: '‚öôÔ∏è –°—ã—Ä–Ω–∞—è –º–∞—à–∏–Ω–∞', desc: '+500 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 250000, type: 'auto', power: 500, scale: 1.9 },
            { id: 'gun', name: 'üî´ –ú–µ–≥–∞-–ø—É—à–∫–∞', desc: '+1500 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 1000000, type: 'auto', power: 1500, scale: 2.0 },
            { id: 'conveyor', name: 'üèóÔ∏è –ö–æ–Ω–≤–µ–π–µ—Ä', desc: '+5000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 5000000, type: 'auto', power: 5000, scale: 2.0 },
            { id: 'factory', name: 'üè≠ –°—ã—Ä–Ω–∞—è —Ñ–∞–±—Ä–∏–∫–∞', desc: '+15000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 25000000, type: 'auto', power: 15000, scale: 2.1 },
            { id: 'megafactory', name: 'üè¢ –ú–µ–≥–∞-—Ñ–∞–±—Ä–∏–∫–∞', desc: '+50000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 100000000, type: 'auto', power: 50000, scale: 2.1 },
            { id: 'corporation', name: 'üåê –ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è', desc: '+150000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 500000000, type: 'auto', power: 150000, scale: 2.2 },
            { id: 'empire', name: 'üëë –°—ã—Ä–Ω–∞—è –∏–º–ø–µ—Ä–∏—è', desc: '+500000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 2500000000, type: 'auto', power: 500000, scale: 2.2 },
            { id: 'galaxy', name: 'üåå –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å–µ—Ç—å', desc: '+1500000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 10000000000, type: 'auto', power: 1500000, scale: 2.3 },
            { id: 'universe', name: 'üåü –í—Å–µ–ª–µ–Ω—Å–∫–∏–π —Å–æ—é–∑', desc: '+5000000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 50000000000, type: 'auto', power: 5000000, scale: 2.3 },
            { id: 'multiverse', name: '‚ôæÔ∏è –ú—É–ª—å—Ç–∏–≤—Å–µ–ª–µ–Ω–Ω–∞—è', desc: '+15000000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 250000000000, type: 'auto', power: 15000000, scale: 2.4 },
            { id: 'dimension', name: 'üîÆ –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Å—ã—Ä–∞', desc: '+50000000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 1000000000000, type: 'auto', power: 50000000, scale: 2.4 },
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
            { id: 'timewarp', name: '‚è∞ –ò—Å–∫–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏', desc: '+100000000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 5000000000000, type: 'auto', power: 100000000, scale: 2.5 },
            { id: 'blackhole', name: '‚ö´ –ß–µ—Ä–Ω–∞—è –¥—ã—Ä–∞', desc: '+300000000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 25000000000000, type: 'auto', power: 300000000, scale: 2.5 },
            { id: 'quantum', name: '‚öõÔ∏è –ö–≤–∞–Ω—Ç–æ–≤—ã–π —Ä–µ–∞–∫—Ç–æ—Ä', desc: '+1000000000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 100000000000000, type: 'auto', power: 1000000000, scale: 2.6 },
            { id: 'infinity', name: '‚àû –ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å', desc: '+3000000000 —Å—ã—Ä–∞/—Å–µ–∫', baseCost: 500000000000000, type: 'auto', power: 3000000000, scale: 2.6 },
        ];

        const intercomsList = [
            { id: 'cyfral', name: 'CYFRAL', bonus: 1.0, cost: 0, desc: '–ë–∞–∑–æ–≤—ã–π –¥–æ–º–æ—Ñ–æ–Ω' },
            { id: 'metakom', name: '–ú–ï–¢–ê–ö–û–ú', bonus: 1.15, cost: 25000, desc: '+15% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'vizit', name: 'VIZIT', bonus: 1.35, cost: 100000, desc: '+35% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'eltis', name: 'ELTIS', bonus: 1.60, cost: 500000, desc: '+60% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'stalker', name: '–°–¢–ê–õ–ö–ï–†', bonus: 2.0, cost: 2500000, desc: '+100% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'factorial', name: '–§–ê–ö–¢–û–†–ò–ê–õ', bonus: 2.5, cost: 10000000, desc: '+150% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'smartlock', name: 'SMARTLOCK', bonus: 3.0, cost: 50000000, desc: '+200% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'quantum', name: 'QUANTUM', bonus: 4.0, cost: 250000000, desc: '+300% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'neuralnet', name: 'NEURALNET', bonus: 5.0, cost: 1000000000, desc: '+400% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
            { id: 'ai', name: 'AI-CORE', bonus: 7.0, cost: 5000000000, desc: '+600% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É' },
        ];

        const saucesList = [
            { id: 'basic', name: '–û–±—ã—á–Ω—ã–π —Å—ã—Ä', bonus: 0, cost: 0, desc: '–ë–∞–∑–æ–≤—ã–π —Å–æ—É—Å' },
            { id: 'cheddar', name: '–ß–µ–¥–¥–µ—Ä', bonus: 10, cost: 15000, desc: '+10 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'mozzarella', name: '–ú–æ—Ü–∞—Ä–µ–ª–ª–∞', bonus: 30, cost: 75000, desc: '+30 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'parmesan', name: '–ü–∞—Ä–º–µ–∑–∞–Ω', bonus: 100, cost: 400000, desc: '+100 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'gorgonzola', name: '–ì–æ—Ä–≥–æ–Ω–∑–æ–ª–∞', bonus: 300, cost: 2000000, desc: '+300 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'dorblue', name: '–î–æ—Ä –ë–ª—é', bonus: 1000, cost: 10000000, desc: '+1000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'roquefort', name: '–†–æ–∫—Ñ–æ—Ä', bonus: 3000, cost: 50000000, desc: '+3000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'brie', name: '–ë—Ä–∏', bonus: 10000, cost: 250000000, desc: '+10000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'camembert', name: '–ö–∞–º–∞–º–±–µ—Ä', bonus: 30000, cost: 1000000000, desc: '+30000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
            { id: 'gruyere', name: '–ì—Ä—é–π–µ—Ä', bonus: 100000, cost: 5000000000, desc: '+100000 —Å—ã—Ä–∞ –∑–∞ –∫–ª–∏–∫' },
        ];

        // 20+ –ï–í–ï–ù–¢–û–í —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
        const eventsList = [
            { id: 'double', name: '–î–≤–æ–π–Ω–æ–π —Å—ã—Ä', icon: 'üßÄüßÄ', multiplier: 2, color: '#f39c12', effect: 'normal' },
            { id: 'triple', name: '–¢—Ä–æ–π–Ω–æ–π —Å—ã—Ä', icon: 'üßÄ√ó3', multiplier: 3, color: '#e67e22', effect: 'normal' },
            { id: 'mega', name: '–ú–µ–≥–∞ –±–æ–Ω—É—Å', icon: 'üí∞', multiplier: 5, color: '#d35400', effect: 'rainbow' },
            { id: 'ultra', name: '–£–ª—å—Ç—Ä–∞ –±–æ–Ω—É—Å', icon: 'üåü', multiplier: 10, color: '#f1c40f', effect: 'stars' },
            { id: 'cosmic', name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π', icon: 'üåå', multiplier: 15, color: '#9b59b6', effect: 'cosmic' },
            { id: 'nuclear', name: '–Ø–¥–µ—Ä–Ω—ã–π –≤–∑—Ä—ã–≤', icon: '‚ò¢Ô∏è', multiplier: 20, color: '#27ae60', effect: 'rainbow' },
            { id: 'quantum', name: '–ö–≤–∞–Ω—Ç–æ–≤—ã–π', icon: '‚öõÔ∏è', multiplier: 25, color: '#3498db', effect: 'cosmic' },
            { id: 'infinity', name: '–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å', icon: '‚àû', multiplier: 50, color: '#8e44ad', effect: 'rainbow' },
            { id: 'godmode', name: '–†–µ–∂–∏–º –±–æ–≥–∞', icon: 'üëë', multiplier: 100, color: '#e74c3c', effect: 'stars' },
            { id: 'lucky', name: '–°—á–∞—Å—Ç–ª–∏–≤—á–∏–∫', icon: 'üçÄ', multiplier: 7, color: '#2ecc71', effect: 'normal' },
            { id: 'golden', name: '–ó–æ–ª–æ—Ç–æ–π —á–∞—Å', icon: 'üèÜ', multiplier: 12, color: '#f39c12', effect: 'rainbow' },
            { id: 'diamond', name: '–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤—ã–π', icon: 'üíé', multiplier: 30, color: '#3498db', effect: 'stars' },
            { id: 'rainbow', name: '–†–∞–¥—É–≥–∞ —É–¥–∞—á–∏', icon: 'üåà', multiplier: 8, color: '#e91e63', effect: 'rainbow' },
            { id: 'fire', name: '–û–≥–Ω–µ–Ω–Ω—ã–π', icon: 'üî•', multiplier: 6, color: '#e67e22', effect: 'normal' },
            { id: 'ice', name: '–õ–µ–¥—è–Ω–æ–π', icon: '‚ùÑÔ∏è', multiplier: 6, color: '#3498db', effect: 'stars' },
            { id: 'thunder', name: '–ì—Ä–æ–∑–æ–≤–æ–π', icon: '‚ö°', multiplier: 9, color: '#f1c40f', effect: 'normal' },
            { id: 'time', name: '–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏', icon: '‚è∞', multiplier: 35, color: '#34495e', effect: 'cosmic' },
            { id: 'space', name: '–ö–æ—Å–º–æ—Å', icon: 'üöÄ', multiplier: 18, color: '#2c3e50', effect: 'cosmic' },
            { id: 'galaxy', name: '–ì–∞–ª–∞–∫—Ç–∏–∫–∞', icon: 'üå†', multiplier: 40, color: '#8e44ad', effect: 'cosmic' },
            { id: 'bigbang', name: '–ë–æ–ª—å—à–æ–π –≤–∑—Ä—ã–≤', icon: 'üí•', multiplier: 75, color: '#c0392b', effect: 'rainbow' },
            { id: 'magic', name: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π', icon: 'üîÆ', multiplier: 14, color: '#9b59b6', effect: 'stars' },
            { id: 'halloween', name: '–•—ç–ª–ª–æ—É–∏–Ω', icon: 'üéÉ', multiplier: 13, color: '#e67e22', effect: 'normal' },
            { id: 'christmas', name: '–†–æ–∂–¥–µ—Å—Ç–≤–æ', icon: 'üéÑ', multiplier: 13, color: '#27ae60', effect: 'stars' },
            { id: 'newyear', name: '–ù–æ–≤—ã–π –≥–æ–¥', icon: 'üéÜ', multiplier: 13, color: '#f39c12', effect: 'rainbow' },
        ];

        upgradesList.forEach(u => {
            if (gameData.upgrades[u.id] === undefined) {
                gameData.upgrades[u.id] = 0;
            }
        });

        const savedUser = localStorage.getItem('soysdomofon_user');
        if (savedUser) {
            currentUser = savedUser;
            loadGameData();
        }

        // –°–ª—É—à–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        const globalMsgRef = ref(database, 'globalMessage');
        onValue(globalMsgRef, (snapshot) => {
            const data = snapshot.val();
            if (data && data.message && data.timestamp > Date.now() - 10000) {
                showGlobalMessage(data.author, data.message);
            }
        });

        // –°–ª—É—à–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –µ–≤–µ–Ω—Ç—ã
        const eventRef = ref(database, 'activeEvent');
        onValue(eventRef, (snapshot) => {
            const data = snapshot.val();
            if (data && data.endTime > Date.now()) {
                activateEvent(data);
            } else {
                deactivateEvent();
            }
        });

        // –°–ª—É—à–∞–µ–º —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã
        if (currentUser) {
            const transfersRef = ref(database, 'transfers/' + currentUser);
            onValue(transfersRef, async (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    for (let key in data) {
                        const transfer = data[key];
                        if (!transfer.processed) {
                            gameData.cheese += transfer.amount;
                            gameData.totalCheese += transfer.amount;
                            gameData.allTimeCheese += transfer.amount;
                            
                            showNotification(`–ü–æ–ª—É—á–µ–Ω –ø–µ—Ä–µ–≤–æ–¥ ${transfer.amount.toLocaleString()} üßÄ –æ—Ç ${transfer.from}`, 'success');
                            
                            await update(ref(database, `transfers/${currentUser}/${key}`), { processed: true });
                            updateUI();
                            saveGame();
                        }
                    }
                }
            });
        }

        document.getElementById('loginTab').addEventListener('click', function() {
            isAuthMode = true;
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            document.getElementById('authButton').textContent = '–í–û–ô–¢–ò';
        });

        document.getElementById('registerTab').addEventListener('click', function() {
            isAuthMode = false;
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            document.getElementById('authButton').textContent = '–ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–¢–¨–°–Ø';
        });

        document.getElementById('authForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const login = document.getElementById('loginInput').value.trim();
            const password = document.getElementById('passwordInput').value;

            if (!login || !password) {
                showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            if (login.length < 3) {
                showError('–õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞');
                return;
            }

            if (password.length < 6) {
                showError('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }

            const userRef = ref(database, 'users/' + login);

            try {
                const snapshot = await get(userRef);

                if (isAuthMode) {
                    if (!snapshot.exists()) {
                        showError('–ê–∫–∫–∞—É–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å!');
                        return;
                    }

                    const userData = snapshot.val();
                    if (userData.password !== password) {
                        showError('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
                        return;
                    }

                    if (userData.gameData && userData.gameData.isBanned) {
                        showError('–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!');
                        return;
                    }

                    currentUser = login;
                    localStorage.setItem('soysdomofon_user', login);
                    showSuccess('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!');
                    setTimeout(() => loadGameData(), 500);

                } else {
                    if (snapshot.exists()) {
                        showError('–≠—Ç–æ—Ç –ª–æ–≥–∏–Ω —É–∂–µ –∑–∞–Ω—è—Ç!');
                        return;
                    }

                    const isAdmin = login === 'qwenixDev01';
                    gameData.isAdmin = isAdmin;

                    await set(userRef, {
                        password: password,
                        login: login,
                        gameData: gameData,
                        createdAt: Date.now()
                    });

                    currentUser = login;
                    localStorage.setItem('soysdomofon_user', login);
                    showSuccess('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!');
                    setTimeout(() => loadGameData(), 500);
                }
            } catch (error) {
                console.error(error);
                showError('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        });

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            const successDiv = document.getElementById('successMessage');
            successDiv.classList.add('hidden');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            setTimeout(() => errorDiv.classList.add('hidden'), 5000);
        }

        function showSuccess(message) {
            const errorDiv = document.getElementById('errorMessage');
            const successDiv = document.getElementById('successMessage');
            errorDiv.classList.add('hidden');
            successDiv.textContent = message;
            successDiv.classList.remove('hidden');
            setTimeout(() => successDiv.classList.add('hidden'), 3000);
        }

        async function loadGameData() {
            const userRef = ref(database, 'users/' + currentUser);
            const snapshot = await get(userRef);

            if (snapshot.exists()) {
                const data = snapshot.val();
                const loadedData = data.gameData || {};
                
                gameData = {
                    ...gameData,
                    ...loadedData,
                    upgrades: loadedData.upgrades || {}
                };

                if (gameData.isBanned) {
                    alert('–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!');
                    localStorage.removeItem('soysdomofon_user');
                    location.reload();
                    return;
                }
                
                upgradesList.forEach(u => {
                    if (gameData.upgrades[u.id] === undefined) {
                        gameData.upgrades[u.id] = 0;
                    }
                });
                
                document.getElementById('playerName').textContent = currentUser;

                if (gameData.isAdmin || currentUser === 'qwenixDev01') {
                    gameData.isAdmin = true;
                    document.getElementById('adminBtn').classList.remove('hidden');
                }
            }

            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            
            renderShop();
            updateUI();
            startGameLoop();
            loadLeaderboard();
            setupEventListeners();
        }

        document.getElementById('logoutBtn').addEventListener('click', async function() {
            await saveGame();
            localStorage.removeItem('soysdomofon_user');
            location.reload();
        });

        document.getElementById('transferBtn').addEventListener('click', function() {
            document.getElementById('transferModal').classList.add('active');
        });

        document.getElementById('adminBtn').addEventListener('click', function() {
            openAdminPanel();
        });

        window.closeTransferModal = function() {
            document.getElementById('transferModal').classList.remove('active');
        };

        window.closeAdminModal = function() {
            document.getElementById('adminModal').classList.remove('active');
        };

        window.sendTransfer = async function() {
            const recipient = document.getElementById('transferRecipient').value.trim();
            const amount = parseInt(document.getElementById('transferAmount').value);

            if (!recipient || !amount || amount <= 0) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'error');
                return;
            }

            if (amount > gameData.cheese) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—ã—Ä–∞', 'error');
                return;
            }

            if (recipient === currentUser) {
                showNotification('–ù–µ–ª—å–∑—è –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Å–∞–º–æ–º—É —Å–µ–±–µ', 'error');
                return;
            }

            const recipientRef = ref(database, 'users/' + recipient);
            const recipientSnapshot = await get(recipientRef);

            if (!recipientSnapshot.exists()) {
                showNotification('–ü–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }

            gameData.cheese -= amount;
            
            const transferId = Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            await set(ref(database, `transfers/${recipient}/${transferId}`), {
                from: currentUser,
                amount: amount,
                timestamp: Date.now(),
                processed: false
            });

            showNotification(`–ü–µ—Ä–µ–≤–æ–¥ ${amount.toLocaleString()} üßÄ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${recipient}`, 'success');
            updateUI();
            saveGame();
            closeTransferModal();
            
            document.getElementById('transferRecipient').value = '';
            document.getElementById('transferAmount').value = '';
        };

        function showNotification(message, type = 'success') {
            const notif = document.createElement('div');
            notif.className = `notification ${type}`;
            notif.textContent = message;
            document.body.appendChild(notif);

            setTimeout(() => {
                notif.remove();
            }, 5000);
        }

        function showGlobalMessage(author, message) {
            const msg = document.createElement('div');
            msg.className = 'global-message';
            msg.innerHTML = `
                <div class="author">${author}</div>
                <div>${message}</div>
            `;
            document.body.appendChild(msg);

            setTimeout(() => {
                msg.remove();
            }, 10000);
        }

        async function openAdminPanel() {
            document.getElementById('adminModal').classList.add('active');
            await loadUsersAdmin();
            renderBroadcastTab();
            renderEventsTab();
        }

        async function loadUsersAdmin() {
            const usersRef = ref(database, 'users');
            const snapshot = await get(usersRef);
            
            let html = '<div class="user-list">';
            
            if (snapshot.exists()) {
                const users = snapshot.val();
                for (let login in users) {
                    const user = users[login];
                    const userData = user.gameData || {};
                    const isBanned = userData.isBanned || false;
                    
                    html += `
                        <div class="user-item ${isBanned ? 'banned' : ''}">
                            <div>
                                <strong>${login}</strong><br>
                                <small>–ë–∞–ª–∞–Ω—Å: ${Math.floor(userData.cheese || 0).toLocaleString()} üßÄ</small><br>
                                <small>–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è: ${userData.rebirths || 0}</small>
                                ${isBanned ? '<br><span style="color: #e74c3c;">–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù</span>' : ''}
                                ${userData.isAdmin ? '<br><span style="color: #f39c12;">–ê–î–ú–ò–ù</span>' : ''}
                            </div>
                            <div>
                                <button class="admin-button" onclick="viewUserLogs('${login}')">–õ–æ–≥–∏</button>
                                <button class="admin-button" onclick="giveBalance('${login}')">–í—ã–¥–∞—Ç—å —Å—ã—Ä</button>
                                ${!userData.isAdmin ? `<button class="admin-button" onclick="toggleAdmin('${login}', ${!userData.isAdmin})">–î–∞—Ç—å –∞–¥–º–∏–Ω–∫—É</button>` : `<button class="admin-button danger" onclick="toggleAdmin('${login}', false)">–ó–∞–±—Ä–∞—Ç—å –∞–¥–º–∏–Ω–∫—É</button>`}
                                ${!isBanned ? `<button class="admin-button danger" onclick="banUser('${login}')">–ó–∞–±–∞–Ω–∏—Ç—å</button>` : `<button class="admin-button" onclick="unbanUser('${login}')">–†–∞–∑–±–∞–Ω–∏—Ç—å</button>`}
                            </div>
                        </div>
                    `;
                }
            }
            
            html += '</div>';
            document.getElementById('usersAdminTab').innerHTML = html;
        }

        function renderBroadcastTab() {
            const html = `
                <div class="admin-section">
                    <h3>–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h3>
                    <textarea id="broadcastMessage" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤"></textarea>
                    <button class="admin-button" onclick="sendBroadcast()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ–º</button>
                </div>
            `;
            document.getElementById('broadcastAdminTab').innerHTML = html;
        }

        function renderEventsTab() {
            let html = `
                <div class="admin-section">
                    <h3>–ó–∞–ø—É—Å–∫ –µ–≤–µ–Ω—Ç–æ–≤</h3>
                    <div class="form-group">
                        <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω—É—Ç—ã)</label>
                        <input type="number" class="admin-input" id="eventDuration" value="10" min="1" max="1440">
                    </div>
                    <div class="event-list">
            `;

            eventsList.forEach(event => {
                html += `
                    <div class="event-card" onclick="startEvent('${event.id}')">
                        <div class="icon">${event.icon}</div>
                        <div class="name">${event.name}</div>
                        <div class="mult">x${event.multiplier}</div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;
            document.getElementById('eventsAdminTab').innerHTML = html;
        }

        window.viewUserLogs = async function(login) {
            const userRef = ref(database, 'users/' + login);
            const snapshot = await get(userRef);
            
            if (snapshot.exists()) {
                const user = snapshot.val();
                const data = user.gameData || {};
                
                alert(`–õ–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${login}:\n\n` +
                    `–ë–∞–ª–∞–Ω—Å: ${Math.floor(data.cheese || 0).toLocaleString()} üßÄ\n` +
                    `–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: ${Math.floor(data.allTimeCheese || 0).toLocaleString()} üßÄ\n` +
                    `–£—Ä–æ–≤–µ–Ω—å: ${data.level || 1}\n` +
                    `–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è: ${data.rebirths || 0}\n` +
                    `–°—ã—Ä–∞/—Å–µ–∫: ${Math.floor(data.cheesePerSecond || 0).toLocaleString()}\n` +
                    `–°—ã—Ä –∑–∞ –∫–ª–∏–∫: ${Math.floor(data.clickPower || 0).toLocaleString()}\n` +
                    `–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${new Date(user.createdAt).toLocaleString()}`
                );
            }
        };

        window.giveBalance = async function(login) {
            const amount = prompt(`–°–∫–æ–ª—å–∫–æ —Å—ã—Ä–∞ –≤—ã–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${login}?`);
            if (!amount || isNaN(amount)) return;

            const userRef = ref(database, `users/${login}/gameData`);
            const snapshot = await get(userRef);
            
            if (snapshot.exists()) {
                const data = snapshot.val();
                await update(userRef, {
                    cheese: (data.cheese || 0) + parseInt(amount),
                    totalCheese: (data.totalCheese || 0) + parseInt(amount),
                    allTimeCheese: (data.allTimeCheese || 0) + parseInt(amount)
                });
                
                showNotification(`–í—ã–¥–∞–Ω–æ ${parseInt(amount).toLocaleString()} üßÄ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${login}`, 'success');
                loadUsersAdmin();
            }
        };

        window.toggleAdmin = async function(login, makeAdmin) {
            const userRef = ref(database, `users/${login}/gameData`);
            await update(userRef, { isAdmin: makeAdmin });
            showNotification(`–ê–¥–º–∏–Ω–∫–∞ ${makeAdmin ? '–≤—ã–¥–∞–Ω–∞' : '–∑–∞–±—Ä–∞–Ω–∞'} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${login}`, 'success');
            loadUsersAdmin();
        };

        window.banUser = async function(login) {
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±–∞–Ω–∏—Ç—å ${login}?`)) return;
            
            const userRef = ref(database, `users/${login}/gameData`);
            await update(userRef, { isBanned: true });
            showNotification(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${login} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`, 'success');
            loadUsersAdmin();
        };

        window.unbanUser = async function(login) {
            const userRef = ref(database, `users/${login}/gameData`);
            await update(userRef, { isBanned: false });
            showNotification(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${login} —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`, 'success');
            loadUsersAdmin();
        };

        window.sendBroadcast = async function() {
            const message = document.getElementById('broadcastMessage').value.trim();
            if (!message) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', 'error');
                return;
            }

            await set(ref(database, 'globalMessage'), {
                author: currentUser,
                message: message,
                timestamp: Date.now()
            });

            showNotification('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—Å–µ–º –∏–≥—Ä–æ–∫–∞–º', 'success');
            document.getElementById('broadcastMessage').value = '';
        };

        window.startEvent = async function(eventId) {
            const duration = parseInt(document.getElementById('eventDuration').value) || 10;
            const event = eventsList.find(e => e.id === eventId);
            
            if (!event) return;

            const eventData = {
                ...event,
                starter: currentUser,
                startTime: Date.now(),
                endTime: Date.now() + (duration * 60 * 1000),
                duration: duration
            };

            await set(ref(database, 'activeEvent'), eventData);
            
            await set(ref(database, 'globalMessage'), {
                author: currentUser,
                message: `–ó–∞–ø—É—Å—Ç–∏–ª –µ–≤–µ–Ω—Ç "${event.name}" ${event.icon} (x${event.multiplier}) –Ω–∞ ${duration} –º–∏–Ω—É—Ç!`,
                timestamp: Date.now()
            });

            showNotification('–ï–≤–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω!', 'success');
        };

        function activateEvent(eventData) {
            currentEventData = eventData;
            currentEventMultiplier = eventData.multiplier;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä –µ–≤–µ–Ω—Ç–∞
            if (!document.getElementById('eventBanner')) {
                const banner = document.createElement('div');
                banner.id = 'eventBanner';
                banner.className = 'event-banner';
                banner.style.borderColor = eventData.color;
                banner.innerHTML = `
                    <div class="event-icon">${eventData.icon}</div>
                    <div class="event-title" style="color: ${eventData.color}">${eventData.name}</div>
                    <div class="event-starter">–ó–∞–ø—É—Å—Ç–∏–ª: ${eventData.starter}</div>
                    <div class="event-multiplier">x${eventData.multiplier}</div>
                    <div class="event-timer" id="eventTimerBanner">–û—Å—Ç–∞–ª–æ—Å—å: ...</div>
                `;
                document.body.appendChild(banner);

                setTimeout(() => {
                    banner.remove();
                }, 8000);
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –µ–≤–µ–Ω—Ç–∞
            if (!document.getElementById('eventIndicator')) {
                const indicator = document.createElement('div');
                indicator.id = 'eventIndicator';
                indicator.className = 'event-indicator';
                indicator.style.borderColor = eventData.color;
                indicator.innerHTML = `
                    <div class="icon">${eventData.icon}</div>
                    <div class="info">
                        <div class="name" style="color: ${eventData.color}">${eventData.name} x${eventData.multiplier}</div>
                        <div class="time" id="eventTimerIndicator">...</div>
                    </div>
                `;
                document.body.appendChild(indicator);
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            createEventEffects(eventData.effect);

            updateEventTimer();
        }

        function deactivateEvent() {
            currentEventMultiplier = 1;
            currentEventData = null;

            const banner = document.getElementById('eventBanner');
            if (banner) banner.remove();

            const indicator = document.getElementById('eventIndicator');
            if (indicator) indicator.remove();

            const effects = document.getElementById('eventEffects');
            if (effects) effects.remove();
        }

        function updateEventTimer() {
            if (!currentEventData) return;

            const remaining = currentEventData.endTime - Date.now();
            if (remaining <= 0) {
                deactivateEvent();
                return;
            }

            const minutes = Math.floor(remaining / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            const timeStr = `${minutes}:${seconds.toString().padStart(2, '0')}`;

            const bannerTimer = document.getElementById('eventTimerBanner');
            if (bannerTimer) bannerTimer.textContent = `–û—Å—Ç–∞–ª–æ—Å—å: ${timeStr}`;

            const indicatorTimer = document.getElementById('eventTimerIndicator');
            if (indicatorTimer) indicatorTimer.textContent = `–û—Å—Ç–∞–ª–æ—Å—å: ${timeStr}`;

            setTimeout(updateEventTimer, 1000);
        }

        function createEventEffects(effectType) {
            let existingEffects = document.getElementById('eventEffects');
            if (existingEffects) existingEffects.remove();

            const container = document.createElement('div');
            container.id = 'eventEffects';
            container.className = 'event-effect';

            if (effectType === 'stars') {
                for (let i = 0; i < 50; i++) {
                    const star = document.createElement('div');
                    star.className = 'star';
                    star.style.left = Math.random() * 100 + '%';
                    star.style.top = Math.random() * 100 + '%';
                    star.style.animationDelay = Math.random() * 2 + 's';
                    container.appendChild(star);
                }
            } else if (effectType === 'cosmic') {
                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'orbit-particle';
                    particle.style.background = `hsl(${Math.random() * 360}, 70%, 60%)`;
                    particle.style.left = '50%';
                    particle.style.top = '50%';
                    particle.style.animationDuration = (5 + Math.random() * 10) + 's';
                    particle.style.animationDelay = Math.random() * 5 + 's';
                    container.appendChild(particle);
                }

                for (let i = 0; i < 100; i++) {
                    const star = document.createElement('div');
                    star.className = 'star';
                    star.style.left = Math.random() * 100 + '%';
                    star.style.top = Math.random() * 100 + '%';
                    star.style.animationDelay = Math.random() * 2 + 's';
                    container.appendChild(star);
                }
            } else if (effectType === 'rainbow') {
                const rainbow = document.createElement('div');
                rainbow.className = 'rainbow-effect';
                container.appendChild(rainbow);
            }

            document.body.appendChild(container);
        }

        async function saveGame() {
            if (!currentUser) return;
            
            try {
                const userRef = ref(database, 'users/' + currentUser + '/gameData');
                await update(userRef, gameData);

                const leaderboardRef = ref(database, 'leaderboard/' + currentUser);
                await set(leaderboardRef, {
                    login: currentUser,
                    cheese: gameData.cheese,
                    allTimeCheese: gameData.allTimeCheese,
                    rebirths: gameData.rebirths,
                    level: gameData.level
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            }
        }

        function renderShop() {
            let upgradesHTML = '';
            upgradesList.forEach(upgrade => {
                const level = gameData.upgrades[upgrade.id] || 0;
                const cost = Math.floor(upgrade.baseCost * Math.pow(upgrade.scale, level) * Math.pow(1.2, gameData.rebirths));
                
                upgradesHTML += `
                    <div class="shop-item">
                        <div class="shop-item-header">
                            <div class="shop-item-name">${upgrade.name}</div>
                            <div class="shop-item-level">–£—Ä. ${level}</div>
                        </div>
                        <div class="shop-item-desc">${upgrade.desc}</div>
                        <div class="shop-item-footer">
                            <div class="shop-item-cost">${cost.toLocaleString()} üßÄ</div>
                            <button class="buy-btn" data-upgrade="${upgrade.id}">–ö—É–ø–∏—Ç—å</button>
                        </div>
                    </div>
                `;
            });
            document.getElementById('upgradesTab').innerHTML = upgradesHTML;

            let intercomsHTML = '';
            intercomsList.forEach(intercom => {
                const owned = gameData.intercoms.includes(intercom.id);
                const active = gameData.currentIntercom === intercom.id;
                
                let buttonHTML = '';
                if (intercom.id === 'cyfral') {
                    buttonHTML = `<button class="select-btn ${active ? 'active' : ''}" data-select-intercom="${intercom.id}">–í—ã–±—Ä–∞–Ω</button>`;
                } else if (owned) {
                    buttonHTML = `<button class="select-btn ${active ? 'active' : ''}" data-select-intercom="${intercom.id}">${active ? '–í—ã–±—Ä–∞–Ω' : '–í—ã–±—Ä–∞—Ç—å'}</button>`;
                } else {
                    buttonHTML = `<button class="buy-btn" data-buy-intercom="${intercom.id}" data-cost="${intercom.cost}">–ö—É–ø–∏—Ç—å</button>`;
                }
                
                intercomsHTML += `
                    <div class="shop-item">
                        <div class="shop-item-header">
                            <div class="shop-item-name">üö™ ${intercom.name}</div>
                        </div>
                        <div class="shop-item-desc">${intercom.desc}</div>
                        <div class="shop-item-footer">
                            <div class="shop-item-cost">${intercom.cost === 0 ? '–ë–ï–°–ü–õ–ê–¢–ù–û' : intercom.cost.toLocaleString() + ' üßÄ'}</div>
                            ${buttonHTML}
                        </div>
                    </div>
                `;
            });
            document.getElementById('intercomsTab').innerHTML = intercomsHTML;

            let saucesHTML = '';
            saucesList.forEach(sauce => {
                const owned = gameData.sauces.includes(sauce.id);
                const active = gameData.currentSauce === sauce.id;
                
                let buttonHTML = '';
                if (sauce.id === 'basic') {
                    buttonHTML = `<button class="select-btn ${active ? 'active' : ''}" data-select-sauce="${sauce.id}">–í—ã–±—Ä–∞–Ω</button>`;
                } else if (owned) {
                    buttonHTML = `<button class="select-btn ${active ? 'active' : ''}" data-select-sauce="${sauce.id}">${active ? '–í—ã–±—Ä–∞–Ω' : '–í—ã–±—Ä–∞—Ç—å'}</button>`;
                } else {
                    buttonHTML = `<button class="buy-btn" data-buy-sauce="${sauce.id}" data-cost="${sauce.cost}">–ö—É–ø–∏—Ç—å</button>`;
                }
                
                saucesHTML += `
                    <div class="shop-item">
                        <div class="shop-item-header">
                            <div class="shop-item-name">üßÄ ${sauce.name}</div>
                        </div>
                        <div class="shop-item-desc">${sauce.desc}</div>
                        <div class="shop-item-footer">
                            <div class="shop-item-cost">${sauce.cost === 0 ? '–ë–ï–°–ü–õ–ê–¢–ù–û' : sauce.cost.toLocaleString() + ' üßÄ'}</div>
                            ${buttonHTML}
                        </div>
                    </div>
                `;
            });
            document.getElementById('sauceTab').innerHTML = saucesHTML;
        }

        document.getElementById('intercom').addEventListener('click', function(event) {
            const clickPower = (gameData.clickPower + gameData.sauceBonus) * currentEventMultiplier;
            const bonusMultiplier = 1 + gameData.rebirths * 0.1;
            const totalGain = Math.floor(clickPower * bonusMultiplier);
            
            gameData.cheese += totalGain;
            gameData.totalCheese += totalGain;
            gameData.allTimeCheese += totalGain;

            createCheeseSplash(event.clientX, event.clientY, totalGain);

            updateUI();
            checkLevelUp();
        });

        function createCheeseSplash(x, y, amount) {
            const splash = document.createElement('div');
            splash.className = 'cheese-splash';
            splash.textContent = `+${amount.toLocaleString()} üßÄ`;
            splash.style.left = x + 'px';
            splash.style.top = y + 'px';
            document.body.appendChild(splash);

            setTimeout(() => splash.remove(), 1500);
        }

        function setupEventListeners() {
            document.addEventListener('click', function(e) {
                if (e.target.dataset.upgrade) {
                    buyUpgrade(e.target.dataset.upgrade);
                } else if (e.target.dataset.buyIntercom) {
                    buyIntercom(e.target.dataset.buyIntercom, parseInt(e.target.dataset.cost));
                } else if (e.target.dataset.selectIntercom) {
                    selectIntercom(e.target.dataset.selectIntercom);
                } else if (e.target.dataset.buySauce) {
                    buySauce(e.target.dataset.buySauce, parseInt(e.target.dataset.cost));
                } else if (e.target.dataset.selectSauce) {
                    selectSauce(e.target.dataset.selectSauce);
                }
            });

            document.querySelectorAll('.shop-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchShopTab(this.dataset.tab);
                });
            });

            document.querySelectorAll('.modal-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchAdminTab(this.dataset.adminTab);
                });
            });

            document.querySelectorAll('.leaderboard-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchLeaderboardTab(this.dataset.lbTab);
                });
            });

            document.getElementById('rebirthBtn').addEventListener('click', doRebirth);
        }

        function switchAdminTab(tab) {
            document.querySelectorAll('.modal-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            document.getElementById('usersAdminTab').classList.add('hidden');
            document.getElementById('broadcastAdminTab').classList.add('hidden');
            document.getElementById('eventsAdminTab').classList.add('hidden');

            if (tab === 'users') {
                document.getElementById('usersAdminTab').classList.remove('hidden');
                loadUsersAdmin();
            } else if (tab === 'broadcast') {
                document.getElementById('broadcastAdminTab').classList.remove('hidden');
            } else if (tab === 'events') {
                document.getElementById('eventsAdminTab').classList.remove('hidden');
            }
        }

        function buyUpgrade(id) {
            const upgrade = upgradesList.find(u => u.id === id);
            if (!upgrade) return;

            const level = gameData.upgrades[id] || 0;
            const cost = Math.floor(upgrade.baseCost * Math.pow(upgrade.scale, level) * Math.pow(1.2, gameData.rebirths));

            if (gameData.cheese >= cost) {
                gameData.cheese -= cost;
                gameData.upgrades[id]++;

                if (upgrade.type === 'click') {
                    gameData.clickPower += upgrade.power;
                } else if (upgrade.type === 'auto') {
                    gameData.cheesePerSecond += upgrade.power;
                }

                renderShop();
                updateUI();
                saveGame();
            }
        }

        function buyIntercom(type, cost) {
            if (gameData.cheese >= cost && !gameData.intercoms.includes(type)) {
                gameData.cheese -= cost;
                gameData.intercoms.push(type);
                selectIntercom(type);
                renderShop();
                updateUI();
                saveGame();
            }
        }

        function selectIntercom(type) {
            gameData.currentIntercom = type;
            const intercom = intercomsList.find(i => i.id === type);
            if (intercom) {
                gameData.intercomBonus = intercom.bonus;
                document.getElementById('intercomName').textContent = intercom.name;
            }
            renderShop();
            updateUI();
            saveGame();
        }

        function buySauce(type, cost) {
            if (gameData.cheese >= cost && !gameData.sauces.includes(type)) {
                gameData.cheese -= cost;
                gameData.sauces.push(type);
                selectSauce(type);
                renderShop();
                updateUI();
                saveGame();
            }
        }

        function selectSauce(type) {
            gameData.currentSauce = type;
            const sauce = saucesList.find(s => s.id === type);
            if (sauce) {
                gameData.sauceBonus = sauce.bonus;
            }
            renderShop();
            updateUI();
            saveGame();
        }

        function getRebirthCost() {
            return Math.floor(1000000 * Math.pow(5, gameData.rebirths));
        }

        function doRebirth() {
            const rebirthCost = getRebirthCost();
            if (gameData.cheese >= rebirthCost) {
                if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è, –¥–æ–º–æ—Ñ–æ–Ω—ã –∏ —Å–æ—É—Å—ã –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã.\n–í—ã –ø–æ–ª—É—á–∏—Ç–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –±–æ–Ω—É—Å +10% –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É!\n\n–¢–µ–∫—É—â–∏–µ –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è: ${gameData.rebirths}\n–°–ª–µ–¥—É—é—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${(rebirthCost * 5).toLocaleString()} üßÄ`)) {
                    gameData.rebirths++;
                    gameData.cheese = 0;
                    gameData.totalCheese = 0;
                    gameData.level = 1;
                    gameData.clickPower = 1;
                    gameData.cheesePerSecond = 0;
                    
                    upgradesList.forEach(u => {
                        gameData.upgrades[u.id] = 0;
                    });
                    
                    gameData.intercoms = ['cyfral'];
                    gameData.currentIntercom = 'cyfral';
                    gameData.sauces = ['basic'];
                    gameData.currentSauce = 'basic';
                    gameData.intercomBonus = 1;
                    gameData.sauceBonus = 0;
                    
                    renderShop();
                    updateUI();
                    saveGame();
                }
            }
        }

        function checkLevelUp() {
            const nextLevel = gameData.level * 5000;
            if (gameData.totalCheese >= nextLevel) {
                gameData.level++;
                updateUI();
            }
        }

        function switchShopTab(tab) {
            document.querySelectorAll('.shop-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            document.getElementById('upgradesTab').classList.add('hidden');
            document.getElementById('intercomsTab').classList.add('hidden');
            document.getElementById('sauceTab').classList.add('hidden');

            if (tab === 'upgrades') {
                document.getElementById('upgradesTab').classList.remove('hidden');
            } else if (tab === 'intercoms') {
                document.getElementById('intercomsTab').classList.remove('hidden');
            } else if (tab === 'sauce') {
                document.getElementById('sauceTab').classList.remove('hidden');
            }
        }

        let currentLeaderboardTab = 'balance';

        function switchLeaderboardTab(tab) {
            currentLeaderboardTab = tab;
            document.querySelectorAll('.leaderboard-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            loadLeaderboard();
        }

        function updateUI() {
            document.getElementById('cheeseCount').textContent = Math.floor(gameData.cheese).toLocaleString();
            document.getElementById('totalCheese').textContent = Math.floor(gameData.allTimeCheese).toLocaleString();
            document.getElementById('levelDisplay').textContent = gameData.level;
            document.getElementById('rebirthCount').textContent = gameData.rebirths;
            document.getElementById('rebirthBonus').textContent = (1 + gameData.rebirths * 0.1).toFixed(1);
            document.getElementById('clickPower').textContent = Math.floor((gameData.clickPower + gameData.sauceBonus) * currentEventMultiplier).toLocaleString();
            
            const cps = Math.floor(gameData.cheesePerSecond * gameData.intercomBonus * (1 + gameData.rebirths * 0.1) * currentEventMultiplier);
            document.getElementById('cheesePerSec').textContent = cps.toLocaleString();
            document.getElementById('intercomsSmeared').textContent = Math.floor(gameData.allTimeCheese / 100);

            const rebirthCost = getRebirthCost();
            document.getElementById('rebirthCost').textContent = rebirthCost.toLocaleString();
            
            const rebirthBtn = document.getElementById('rebirthBtn');
            if (gameData.cheese >= rebirthCost) {
                rebirthBtn.disabled = false;
            } else {
                rebirthBtn.disabled = true;
            }
        }

        async function loadLeaderboard() {
            const leaderboardRef = ref(database, 'leaderboard');
            onValue(leaderboardRef, (snapshot) => {
                const data = snapshot.val();
                if (!data) {
                    document.getElementById('leaderboardList').innerHTML = '<div style="text-align: center; color: #bdc3c7; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
                    return;
                }

                let leaders = Object.values(data);

                if (currentLeaderboardTab === 'balance') {
                    leaders.sort((a, b) => b.cheese - a.cheese);
                } else if (currentLeaderboardTab === 'rebirths') {
                    leaders.sort((a, b) => b.rebirths - a.rebirths);
                } else if (currentLeaderboardTab === 'all') {
                    leaders.sort((a, b) => {
                        const scoreA = b.allTimeCheese + (b.rebirths * 1000000);
                        const scoreB = a.allTimeCheese + (a.rebirths * 1000000);
                        return scoreA - scoreB;
                    });
                }

                leaders = leaders.slice(0, 10);
                
                const leaderboardHTML = leaders.map((leader, index) => {
                    const rankClass = index === 0 ? 'gold' : index === 1 ? 'silver' : index === 2 ? 'bronze' : '';
                    
                    let scoreText = '';
                    if (currentLeaderboardTab === 'balance') {
                        scoreText = `${Math.floor(leader.cheese || 0).toLocaleString()} üßÄ`;
                    } else if (currentLeaderboardTab === 'rebirths') {
                        scoreText = `‚≠ê ${leader.rebirths || 0}`;
                    } else {
                        scoreText = `${Math.floor(leader.allTimeCheese || 0).toLocaleString()} üßÄ + ‚≠ê${leader.rebirths || 0}`;
                    }
                    
                    return `
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank ${rankClass}">${index + 1}</div>
                            <div class="leaderboard-player">${leader.login}</div>
                            <div class="leaderboard-score">${scoreText}</div>
                        </div>
                    `;
                }).join('');

                document.getElementById('leaderboardList').innerHTML = leaderboardHTML;
            });
        }

        function startGameLoop() {
            setInterval(() => {
                const cps = gameData.cheesePerSecond * gameData.intercomBonus * (1 + gameData.rebirths * 0.1) * currentEventMultiplier;
                gameData.cheese += cps / 10;
                gameData.totalCheese += cps / 10;
                gameData.allTimeCheese += cps / 10;
                updateUI();
                checkLevelUp();
            }, 100);

            setInterval(() => {
                saveGame();
            }, 10000);
        }
    </script>
</body>
</html>
